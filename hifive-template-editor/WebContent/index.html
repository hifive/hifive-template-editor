<!doctype html>
<!--
/*
 * Copyright (C) 2013-2014 NS Solutions Corporation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
 -->

<html lang="ja">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>EJS Template Editor</title>

<link rel="stylesheet" href="res/lib/jstree/jstree.custom.css">

<link rel="stylesheet" href="res/lib/bootstrap3.2/css/bootstrap.css" media="screen">
<link rel="stylesheet" href="res/lib/hifive/h5.css">

<link rel="stylesheet" href="/hifive-ui-library/components/dividedBox/src/DividedBox.css">

<link rel="stylesheet" href="res/lib/editor-external.css">

<link rel="stylesheet" href="index.css">


<script src="res/lib/jquery/jquery-2.0.3.min.js"></script>

<script src="res/lib/bootstrap3.2/js/bootstrap.js"></script>

<script src="res/lib/jstree/jquery.jstree.js"></script>


<script src="res/lib/hifive/ejs-h5mod.js"></script>
<script src="res/lib/hifive/h5.js"></script>
<script src="res/lib/hifive/h5.dev.js"></script>

<script src="hifive/templateEditor/js/h5.ext.js"></script>


<script src="hifive/templateEditor/js/constants.js"></script>
<script src="hifive/templateEditor/js/u.js"></script>

<script src="hifive/templateEditor/js/_.js"></script>

<script src="hifive/templateEditor/js/hifiveEditorServer.js"></script>

<script>
	h5.u.obj.ns('hifive.templateEditor.settings').srcBase = '/hifive-template-editor/WebContent/hifive';

	h5.u.obj.ns('hifive.templateEditor.settings').fileStoreBase = '/hifive-template-editor/WebContent/hifive/templateEditor/storage/files/';
	h5.u.obj.ns('hifive.templateEditor.settings').pathHandwritingController = '/hifive-template-editor/WebContent/hifive/templateEditor/controller/HandwritingController.js';

	h5.u.obj.ns('hifive.templateEditor.settings').savePathBase = '/hifive-template-editor/WebContent/hifive/templateEditor/storage/files/';


	//JsBaseとCssBaseは同一でもよい
	h5.u.obj.ns('hifive.templateEditor.settings').libraryJsBase = '/hifive-template-editor/WebContent/res/lib';
	h5.u.obj.ns('hifive.templateEditor.settings').libraryCssBase = '/hifive-template-editor/WebContent/res/lib';

	//h5.u.obj.ns('hifive.editor.settings').userLibraryJsBase = '/hifiveVisualEditor/lib';
	//h5.u.obj.ns('hifive.editor.settings').userLibraryCssBase = '/hifiveVisualEditor/lib';


	h5.ext.basePath = './';
	h5.core.controller.registerAlias('c', 'hifive.templateEditor.controller');
</script>

<script src="hifive/templateEditor/js/dependencyMap.js"></script>

<script src="hifive/templateEditor/controller/GenericParameterEditController.js"></script>

<script src="hifive/templateEditor/controller/PreviewController.js"></script>
<script src="hifive/templateEditor/controller/SourceEditorController.js"></script>
<script src="hifive/templateEditor/controller/TemplateEditController.js"></script>

<script src="/hifive-ui-library/components/dividedBox/src/DividedBox.js"></script>



<!-- u.jsが必要 -->
<script>
	// 環境変数の設定
	hifive.editor.u.setEnv('SYSTEM_LIB', '/hifive-template-editor/WebContent/res/lib');
	// 	hifive.editor.u.setEnv('USER_LIB', '/hifiveVisualEditor/editor/lib');
</script>

<script src="hifive/templateEditor/parts/ui/ui.common.js"></script>
<script src="hifive/templateEditor/parts/ui/base/base.js"></script>
<script src="hifive/templateEditor/parts/ui/layout/layout.js"></script>
<!-- <script src="parts/ui/hifive/components.js"></script> -->
<!-- <script src="parts/ui/bootstrap/bootstrap.js"></script> -->
<script src="hifive/templateEditor/parts/bootstraps3/bootstrap.js"></script>

<script src="/quiz/res/src/common/util.js"></script>



<script>
	$(window).bind('message', function(e) {
		var myOrigin = location.protocol + '//' + location.host;
		if (e.origin === myOrigin) {

			$('#ejsEditorRoot').trigger(e.data.eventName, e.data.data);

		} else {
			console.log('originが一致していない');
		}
	});

	$('.dividedBox').each(function() {
		h5.core.controller(this, h5.ui.container.DividedBox);
	});

	$(window).bind('resize', function() {
		var dividedBoxes = h5.core.controllerManager.getControllers(document.body, {
			name: 'h5.ui.container.DividedBox',
			deep: true
		});

		for (var i = 0, len = dividedBoxes.length; i < len; i++) {
			dividedBoxes[i].refresh();
		}
	});

	$('iframe').load(function() {
		console.log('load comp');
	});
</script>

<script src="sample.js"></script>


</head>
<body class='bg-carbon'>
	<div class="rootBox">


		<div id="ejsEditorRoot" class="dividedBox vertical container">


			<div class="tabPanels">

				<!-- 適用しているテンプレートIDを表示 -->
				<span class="templateIdText"></span>
				<button class="btn btn-primary applyTemplateBtn">再適用</button>
				<span class="statusMessage"></span>

				<!-- タブ -->
				<ul class="nav nav-tabs">
					<li class="active"><a href="#template" data-toggle="tab">テンプレート文字列</a></li>
					<li><a href="#data" data-toggle="tab">データオブジェクト(JSON形式)</a></li>
					<li><a href="#css" data-toggle="tab">カスタムCSS</a></li>
					<li><a href="#setting" data-toggle="tab">設定</a></li>
				</ul>

				<!-- タブコンテント -->
				<div class="tab-content">

					<!-- 【テンプレート文字列】 -->
					<div class="tab-pane active" id="template">
						<div class="row-fluid inputArea">
							<div class="span12">
								<h5>テンプレート文字列</h5>
								<!-- FIXME pageWrapperがついてないとPaletteがドロップしない -->
								<div class="sourceText pageWrapper col-xs-9">
									<!-- contentEditable="true" -->
								</div>
								<div class="componentPalette col-xs-3" data-h5-controller="c:ComponentPaletteController"></div>
							</div>
						</div>
					</div>

					<!-- 【データオブジェクト(JSON形式)】 -->
					<div class="tab-pane" id="data">
						<div class="row-fluid col-xs-12">
							<h5>データオブジェクト(JSON形式)</h5>
							<textarea class="span12 dataText"></textarea>
						</div>
					</div>

					<!-- 【カスタムCSS】 -->
					<div class="tab-pane" id="css">カスタムCSS</div>

					<!-- 【設定】 -->
					<div class="tab-pane" id="setting">
						<ul class="lib-list">
							<li><input class="lib" type="checkbox" value="bs3.2">Bootstrap3.2</li>
							<li><input class="lib" type="checkbox" value="dummy">dummy</li>
						</ul>
						<input class="applyLibBtn" type="button" name="ok" value="適用" style="color: red">
					</div>


				</div>
			</div>


			<div class="applyTemplate col-xs-12">
				<h5>テンプレート適用先</h5>
				<!-- <div class="templateApplicationRoot"></div> -->
				<iframe class="frame col-xs-12" src="result.html"></iframe>
			</div>

		</div>

	</div>
</body>
</html>
